<!-- ========== HEADER ========== -->
<header id="main-header" class="fixed top-0 left-0 right-0 w-full flex flex-wrap lg:justify-start lg:flex-nowrap z-50 py-2 bg-white/70 backdrop-blur-xl border-b border-gray-200/50 shadow-sm transition-all duration-300">
  <nav class="relative max-w-7xl w-full flex flex-wrap lg:grid lg:grid-cols-12 basis-full items-center px-4 md:px-6 lg:px-8 mx-auto">
    <div class="lg:col-span-3 flex items-center">
      <!-- Logo -->
      <div class="flex items-center gap-3">
        <div class="flex h-10 w-10 items-center justify-center bg-black text-white rounded-none border border-black">
          <span class="material-symbols-outlined text-2xl">all_inclusive</span>
        </div>
        <span class="text-xl font-bold tracking-tighter uppercase relative z-10"><a href="/">RDN.BY</a></span>
      </div>
      <!-- End Logo -->
    </div>

    <!-- Button Group -->
    <div class="flex items-center gap-x-1 lg:gap-x-2 ms-auto py-1 lg:ps-6 lg:order-3 lg:col-span-3 lg:justify-end">
      <a href="#global-contact" id="btn-order-project" class="group relative hidden sm:inline-flex justify-center items-center py-3 px-6 border border-black text-xs font-bold tracking-[0.15em] text-nowrap uppercase text-white bg-black transition-colors duration-500 hover:bg-white focus:outline-hidden overflow-hidden">
        <span class="relative z-10 transition-opacity duration-300 group-hover:opacity-0">Заказать проект</span>
        <span class="absolute left-0 inset-y-0 w-0 z-20 overflow-hidden bg-white flex items-center text-black border-r-2 border-transparent group-hover:w-full group-hover:border-black transition-all duration-500 ease-out">
          <span class="pl-6 pr-6 whitespace-nowrap">Заказать Проект</span>
        </span>
      </a>

      <div class="lg:hidden ml-2 z-20">
        <button type="button" class="size-9.5 flex justify-center items-center text-sm font-semibold rounded-xl border border-gray-200 text-gray-800 hover:bg-gray-100 focus:outline-hidden focus:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none" id="hs-pro-hcail-collapse" aria-expanded="false" aria-controls="hs-pro-hcail" aria-label="Toggle navigation">
          <svg id="nav-icon-burger" class="shrink-0 size-4 block" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" x2="21" y1="6" y2="6"/><line x1="3" x2="21" y1="12" y2="12"/><line x1="3" x2="21" y1="18" y2="18"/></svg>
          <svg id="nav-icon-close" class="shrink-0 size-4 hidden" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
        </button>
      </div>
    </div>
    <!-- End Button Group -->

    <!-- Collapse -->
    <div id="hs-pro-hcail" class="hidden transition-all duration-300 basis-full grow lg:block lg:w-auto lg:basis-auto lg:order-2 lg:col-span-6 z-10" aria-labelledby="hs-pro-hcail-collapse" role="region">
      <div class="flex flex-col gap-y-4 gap-x-0 mt-5 lg:flex-row lg:justify-center lg:items-center lg:gap-y-0 lg:gap-x-10 lg:mt-0 bg-white lg:bg-transparent p-4 lg:p-0">
        {% set current_path = app.request.pathinfo %}
        {% set menu_links = [
          { name: 'Главная', url: '/' },
          { name: 'Услуги', url: '/services' },
          { name: 'Блог', url: '/blog' },
          { name: 'О нас', url: '/about' },
          { name: 'Контакты', url: '/contacts' }
        ] %}

        {% for link in menu_links %}
          {% set is_active = (current_path == link.url) %}
          <div>
            <a class="relative inline-block text-xs font-bold uppercase tracking-[0.1em] {{ is_active ? 'text-black' : 'text-gray-500 hover:text-black transition-colors' }} focus:outline-hidden" href="{{ link.url }}" {{ is_active ? 'aria-current="page"' : '' }}>
              {{ link.name }}
              {% if is_active %}
                <span class="absolute -bottom-1 left-0 w-full h-[2px] bg-black"></span>
              {% endif %}
            </a>
          </div>
        {% endfor %}
      </div>
    </div>
    <!-- End Collapse -->
  </nav>

  <!-- Scroll Progress Bar -->
  <div class="absolute bottom-0 left-0 h-[2px] bg-black z-50 transition-width duration-75 ease-out" id="scroll-progress-bar" style="width: 0%;"></div>
</header>
<!-- Add padding wrapper to offset fixed header -->
<div class="pt-[60px]"></div>
<!-- ========== END HEADER ========== -->

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const progressBar = document.getElementById('scroll-progress-bar');
    if (progressBar) {
      window.addEventListener('scroll', () => {
        const scrollTotal = document.documentElement.scrollHeight - document.documentElement.clientHeight;
        if (scrollTotal <= 0) return;
        const scrollPosition = window.scrollY;
        const progress = (scrollPosition / scrollTotal) * 100;
        progressBar.style.width = progress + '%';
      });
    }

    const btnOrder = document.getElementById('btn-order-project');
    if (btnOrder) {
      btnOrder.addEventListener('click', (e) => {
        const target = document.getElementById('global-contact');
        if (target) {
          e.preventDefault();
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      });
    }

    // Vanilla mobile menu implementation (saves 112KB by bypassing preline.js)
    const toggleBtn = document.getElementById('hs-pro-hcail-collapse');
    const menu = document.getElementById('hs-pro-hcail');
    const iconBurger = document.getElementById('nav-icon-burger');
    const iconClose = document.getElementById('nav-icon-close');

    if (toggleBtn && menu) {
        toggleBtn.addEventListener('click', () => {
            const isExpanded = toggleBtn.getAttribute('aria-expanded') === 'true';
            
            if (isExpanded) {
                // Close it
                menu.classList.add('hidden');
                iconBurger.classList.remove('hidden');
                iconBurger.classList.add('block');
                iconClose.classList.add('hidden');
                iconClose.classList.remove('block');
                toggleBtn.setAttribute('aria-expanded', 'false');
            } else {
                // Open it
                menu.classList.remove('hidden');
                iconBurger.classList.add('hidden');
                iconBurger.classList.remove('block');
                iconClose.classList.remove('hidden');
                iconClose.classList.add('block');
                toggleBtn.setAttribute('aria-expanded', 'true');
            }
        });
    }
  });
</script>