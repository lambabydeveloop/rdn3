{# 1. НАСЛЕДОВАНИЕ базового шаблона #}
{% extends 'base.html.twig' %}

{# 2. ПЕРЕОПРЕДЕЛЕНИЕ заголовка страницы #}
{% block title %}
    {{ seo.title|default('О нашей студии RDN.BY') }} | SEO Studio RDN.BY
{% endblock %}

{# 3. Добавление специфичных стилей для этой страницы #}
{% block stylesheets %}
    {{ parent() }} {# ← ВАЖНО: сохраняем родительские стили #}
    <link rel="stylesheet" href="{{ asset('assets/css/index_home.css') }}">
{% endblock %}
{% block schema_org %}
    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "ProfessionalService",
            "name": "RDN.BY",
            "description": "SEO и GEO студия по разработке и продвижению сайтов в Беларуси",
            "url": "https://rdn.by",
            "logo": "https://rdn.by/images/logo.png",
            "telephone": "+375259997490",
            "email": "info@rdn.by",
            "address": {
                "@type": "PostalAddress",
                "streetAddress": "пр. Независимости 58, офис 415",
                "addressLocality": "Минск",
                "addressCountry": "BY"
            },
            "priceRange": "400-1500 BYN",
            "aggregateRating": {
                "@type": "AggregateRating",
                "ratingValue": "4.9",
                "reviewCount": "86"
            }
        }
    </script>

    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Service",
            "name": "SEO-продвижение",
            "provider": {
                "@type": "Organization",
                "name": "RDN.BY"
            },
            "offers": {
                "@type": "Offer",
                "price": "1500",
                "priceCurrency": "BYN"
            }
        }
    </script>

    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Service",
            "name": "GEO-оптимизация для ИИ",
            "provider": {
                "@type": "Organization",
                "name": "RDN.BY"
            },
            "offers": {
                "@type": "Offer",
                "price": "900",
                "priceCurrency": "BYN"
            }
        }
    </script>

    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Service",
            "name": "Сквозная аналитика",
            "provider": {
                "@type": "Organization",
                "name": "RDN.BY"
            },
            "offers": {
                "@type": "Offer",
                "price": "600",
                "priceCurrency": "BYN"
            }
        }
    </script>

    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Service",
            "name": "Контекстная реклама",
            "provider": {
                "@type": "Organization",
                "name": "RDN.BY"
            },
            "offers": {
                "@type": "Offer",
                "price": "800",
                "priceCurrency": "BYN"
            }
        }
    </script>

    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Service",
            "name": "Комплексная диагностика",
            "provider": {
                "@type": "Organization",
                "name": "RDN.BY"
            },
            "offers": {
                "@type": "Offer",
                "price": "400",
                "priceCurrency": "BYN"
            }
        }
    </script>

    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "FAQPage",
            "mainEntity": [
                {
                    "@type": "Question",
                    "name": "Сколько стоит SEO-продвижение?",
                    "acceptedAnswer": {
                        "@type": "Answer",
                        "text": "Стоимость SEO-продвижения от 1500 BYN в месяц"
                    }
                },
                {
                    "@type": "Question",
                    "name": "Что такое GEO-оптимизация?",
                    "acceptedAnswer": {
                        "@type": "Answer",
                        "text": "GEO-оптимизация это подготовка контента для ИИ-систем"
                    }
                }
            ]
        }
    </script>
{% endblock %}

{# 4. ОСНОВНОЙ КОНТЕНТ страницы #}
{% block body %}
    {% include 'partials/header.html.twig' %}

    <main class="relative bg-white z-10 w-full overflow-hidden" id="main-content">
        {% include 'partials/home/capabilities.html.twig' %}
        {% include 'partials/home/products.html.twig' %}
        {% include 'partials/home/process.html.twig' %}
        {% include 'partials/home/projects.html.twig' %}
        {% include 'partials/home/investment.html.twig' %}
        {% include 'partials/home/blog_grid.html.twig' %}
        {% include 'partials/home/intelligence_faq.html.twig' %}
    </main>

    {# GSAP Scroll Animations for the new sections #}
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof gsap === 'undefined' || typeof ScrollTrigger === 'undefined') return;
            
            gsap.registerPlugin(ScrollTrigger);

            // 1. Fade-in up animations for elements
            const revealElements = document.querySelectorAll('.js-reveal');
            revealElements.forEach((el) => {
                gsap.fromTo(el, 
                    { y: 40, opacity: 0 }, 
                    {
                        y: 0, 
                        opacity: 1,
                        duration: 1,
                        ease: 'power3.out',
                        scrollTrigger: {
                            trigger: el,
                            start: 'top 85%', // Trigger when top of element hits 85% of viewport
                            toggleActions: 'play none none reverse'
                        }
                    }
                );
            });

            // 2. Section Overlap Parallax Effect
            // Instead of sticky CSS which breaks tall mobile sections, we use GSAP to slightly 
            // push the previous section down as the new one rolls over it.
            const sections = document.querySelectorAll('.section-overlap');
            
            sections.forEach((section, index) => {
                // Set z-index dynamically so each subsequent section sits on top
                section.style.zIndex = index + 10;
                
                if (index > 0) {
                    const prevSection = sections[index - 1];
                    
                    // Add subtle shadow to top edge of current section to emphasize overlap
                    if(!section.classList.contains('bg-black')) {
                       section.style.boxShadow = "0 -20px 40px -20px rgba(0,0,0,0.1)";
                    }
                    
                    // As THIS section scrolls up from the bottom, push the PREVIOUS section down slightly
                    // Note: We use yPercent so it scales relative to the section's height
                    gsap.to(prevSection, {
                        yPercent: 15,
                        ease: "none",
                        scrollTrigger: {
                            trigger: section,
                            start: "top bottom", // When top of *this* section hits bottom of window
                            end: "top top",      // Until top of *this* section hits top of window
                            scrub: true
                        }
                    });
                }
            });
        });
    </script>
{% endblock %}

{# 5. Добавление специфичного JavaScript для этой страницы #}
{% block javascripts %}
    {{ parent() }} {# ← ВАЖНО: сохраняем родительские скрипты #}
    <script src="{{ asset('assets/js/index_home.js') }}"></script>

{% endblock %}

{# 6. Дополнительный контент в конце body (если нужно) #}
{% block body_end %}
    {# Можно добавить модальные окна, дополнительные виджеты и т.д. #}

{% endblock %}

